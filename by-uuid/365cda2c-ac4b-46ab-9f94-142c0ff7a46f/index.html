<html>

<head>
    <meta charset="UTF-8">
    <script>
        function terminate() {
            var testerName = document.getElementById("testerName").value;

            if (testerName == null || testerName == "") {
                alert("姓名不可为空。请检查你输入的字符并再次提交。")
            }
            else {
                var testerUnit = document.getElementById("testerUnit").value;

                if (testerUnit == null || testerUnit == "") {
                    alert("单位不可为空。请检查你输入的字符并再次提交。")
                }
                else {
                    if (window.confirm("确认提交答卷？")) {
                        var cores = 0;
                        var qestions = document.getElementsByClassName("question");
                        for (var i = 0; i < qestions.length; i++) {
                            var count = 0;
                            var flag = 1;
                            var answer = document.getElementsByName("answer" + (i + 1));
                            for (var j = 0; j < answer.length; j++) {
                                if (answer[j].checked) {
                                    if (answer[j].value * 1 < 0) {
                                        flag = 0;
                                        break;
                                    }
                                    else
                                        count += answer[j].value * 1;
                                }
                            }
                            if (flag == 1)
                                cores += count;
                        }

                        var dateEnd = new Date();
                        var timestampEnd = dateEnd.getTime();
                        var timestampDuration = timestampEnd - timestampStart;

                        alert("☆ 测试结果\n\n姓名　" + testerName + "\n单位　" + testerUnit + "\n\n开始时间　" + dateStart.toLocaleString() + "\n结束时间　" + dateEnd.toLocaleString() + "\n用时　" + parseInt(timestampDuration / 1000 / 60) + "分钟\n\n分数　" + cores + "\n\n截图或拍摄本页以存储测试记录。");
                    }
                    else {
                        return false;
                    }
                }
            }
        }
        window.addEventListener("beforeunload", (event) => {
            // Cancel the event as stated by the standard.
            event.preventDefault();
            // Chrome requires returnValue to be set.
            event.returnValue = "";
        });

        var dateStart = new Date();
        var timestampStart = dateStart.getTime();

        setTimeout(() => {
            alert("作答时间到。请查看你的结果。")
            while (true) {
                terminate();
            }
        }, 3600000);
    </script>

    <style>
        body {
            font-family: 'Times New Roman', Times, serif;
        }
    </style>
</head>

<body>
    <div class="center">
        <h1>中国古代诗词简易测试</h1>
    </div>

    <div class="box">
        <span class="one"></span>
        <span class="two"></span>
    </div>
    <script>
        var timer = setTimeout(function () {
            var one = document.querySelector('.one');
            var two = document.querySelector('.two');
            var date = new Date();
            var year = date.getFullYear();
            var month = date.getMonth() + 1;
            var dates = date.getDate();
            var arr = ['周日', '周一', '周二', '周三', '周四', '周五', '周六',];
            var day = arr[date.getDay()];
            one.innerHTML = (year + '年' + month + '月' + dates + '日 ' + day);
            two.innerHTML = (getTime());
            clearInterval(timer);

        });

        setInterval(function () {
            var one = document.querySelector('.one');
            var two = document.querySelector('.two');
            var date = new Date();
            var year = date.getFullYear();
            var month = date.getMonth() + 1;
            var dates = date.getDate();
            var arr = ['周日', '周一', '周二', '周三', '周四', '周五', '周六',];
            var day = arr[date.getDay()];
            one.innerHTML = (year + '年' + month + '月' + dates + '日 ' + day);
            two.innerHTML = (getTime());
        }, 1000);

        function getTime() {
            var time = new Date();
            var h = time.getHours();
            h = h < 10 ? '0' + h : h;
            var m = time.getMinutes();
            m = m < 10 ? '0' + m : m;
            var s = time.getSeconds();
            s = s < 10 ? '0' + s : s;
            return h + ':' + m + ':' + s;
        }
    </script>

    <br />

    <p>本测试的作答时间为1小时，共100道题目。时间截止时将自动交卷。请在规定时间内作答完毕。</p>

    <div>
        <form>
            <fieldset id="grey">
                姓名 <input type="text" id="testerName"><br />
                单位 <input type="text" id="testerUnit"><br />
                </filedset>
        </form>
    </div>

    <br />
    <fieldset class="question">
        <p id="1">1. “长风破浪会有时, 直挂云帆济沧海。” 出自下列哪一首诗？</p>
        <label><input type="radio" name="answer1" value="1" />A. 《行路难》</label>
        <br />
        <label><input type="radio" name="answer1" value="0" />B. 《蜀道难》</label>
        <br />
        <label><input type="radio" name="answer1" value="0" />C. 《长恨歌》</label>
    </fieldset>
    <fieldset class="question">
        <p id="2">2. “蓦然回首，那人却在，灯火阑珊处。”出自什么朝代、哪一位诗人的作品？</p>
        <label><input type="radio" name="answer2" value="0" />A. 北宋 辛弃疾</label>
        <br />
        <label id="2"><input type="radio" name="answer2" value="1" />B. 南宋 辛弃疾<label>
                <br />
                <label><input type="radio" name="answer2" value="0" />C. 南宋 李清照</label>
    </fieldset>
    <br />
    <button style="width: 80px; height: 40px; font-size: medium; font-family: 'Times New Roman', Times, serif;"
        onclick="terminate()">提交答卷</button>
</body>

</html>